version: 2.1
orbs:
   aws-cli: circleci/aws-cli@1.0
   serverless: circleci/serverless-framework@1.0
   node: circleci/node@4.7.0
jobs:
  deploy:
     executor: serverless/default
     steps:
      - checkout
      - aws-cli/setup
      - serverless/setup:
          app-name: serverless-framework-orb
          org-name: circleci
      - node/install-packages:
          cache-path: ~/project/node_modules
          override-ci-command: yarn i
      - run:
          command: yarn run test
          name: Run YARN tests
workflows:
  deploy:
    jobs:
      - deploy
      - node/run:
          yarn-run: build